{% extends 'main.html' %}
{% load static %}

{% block content %}

<main class="main_container">
    <div class="main_form_container">
        <div class="wrapper">
            <section class="form login">
                <form method="POST" novalidate>
                    {% csrf_token %}
                    <div id="error-message">
                    </div>

                    <div class="multistep_form_tab">
                        <div class="form_back_section">
                            <span class="step-indicator">1 de 5</span>
                        </div>



                        <div class="form_header">
                            <h3>Datos generales de tu mascota</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                        </div>

                        <div class="form_name_input">
                            <div class="field input">
                                <input type="text" name="name" placeholder="Nombre" value="{{ puppy.name }}" id="input_name" onchange="getName();" required>
                            </div>
                        </div>

                        <div class="form_age_sex_input">
                            <div class="field input">
                                <input type="number" name="age" placeholder="Edad" value="{{ puppy.age }}" required>
                            </div>

                            <div class="field input input_age_type">
                                <select id="sex" name="age_type" option="años" required>
                                    <option value="meses" {% if puppy.age_type == 'meses' %}selected{% endif %}>Meses</option>
                                    <option value="años" {% if puppy.age_type == 'años' %}selected{% endif %}>Años</option>
                                </select>
                            </div>
                        </div>

                        <div class="field input">
                            <select id="sex" name="reproductive_state" placeholder="Estado" option="castrado" required>
                                <option value="castrado" {% if puppy.reproductive_state == 'castrado' %}selected{% endif %}>Castrado</option>
                                <option value="entero" {% if puppy.reproductive_state == 'entero' %}selected{% endif %}>Entero</option>
                            </select>
                        </div>

                        <div class="form_breed_input">
                            <div class="field input">
                                <input list="breed" name="breed" placeholder="Raza" {% if puppy %}value="{{ puppy.breed }}" {% endif %} required>
                                <datalist id="breed">
                                    <option value="">select</option>
                                    {% for breed in breeds %}
                                    <option value="{{ breed.name }}">{{ breed.name }}</option>
                                    {% endfor %}
                                </datalist>
                            </div>
                        </div>


                        <div class="field button">
                            <button type="button" id="nextBtn" onclick="nextPrev(1)">Continuar</button>
                        </div>

                        <div class="link"><a href="{% url 'login' %}">Cancelar</a></div>
                    </div>
                    
                    <div class="multistep_form_tab">
                        <div class="form_back_section">
                        <span class="step-indicator">2 de 5</span>
                            <div class="back_icon_container">
                                <i class="fa fa-angle-left"></i>
                                <button type="button" onclick="nextPrev(-1)" class="multistep_form_back_button"><p>Volver</p></button>
                            </div>
                        </div>

                        <div class="form_header">
                            <h3>¿Consume alimentación natural?</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                        </div>

                        <div class="radio_inputs_container">
                            <p>
                                <input type="radio" name="natural_food" value="yes" {% if not puppy.is_barf_active or puppy.is_barf_active == 'yes' %}checked{% endif %}>Si</input>
                            </p>
                            <p>
                                <input type="radio" name="natural_food" value="no" {% if puppy.is_barf_active == 'no' %}checked{% endif %}>No</input>
                            </p>
                        </div>

                        <div class="field button">
                            <button type="button" id="nextBtn" onclick="nextPrev(1)">Continuar</button>
                        </div>

                        <div class="link"><a href="{% url 'login' %}">Cancelar</a></div>
                    </div>

                    <div class="multistep_form_tab">
                        <div class="form_back_section">
                            <span class="step-indicator">3 de 5</span>
                            <div class="back_icon_container">
                                <i class="fa fa-angle-left"></i>
                                <button type="button" onclick="nextPrev(-1)" class="multistep_form_back_button"><p>Volver</p></button>
                            </div>
                        </div> 

                        <div class="form_header">
                            <h3>Actividad</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                        </div>
                    
                        <div class="radio_inputs_container__activity">
                            <p>
                                <input type="radio" name="activity_level" value="bajo" class="activity_input" onClick="changeImg(this.value);" {% if puppy.activity_level == "bajo" or not puppy.activity_level %}checked{% endif %}>Sedentario</input>
                            </p>
                            <p>
                                <input type="radio" name="activity_level" value="medio" class="activity_input" onClick="changeImg(this.value);" {% if puppy.activity_level == "medio" %}checked{% endif %}>Activo</input>
                            </p>
                            <p>
                                <input type="radio" name="activity_level" value="alto" class="activity_input" onClick="changeImg(this.value);" {% if puppy.activity_level == "alto" %}checked{% endif %}>Muy activo</input>
                            </p>
                        </div>

                        <div class="activity_image_container">
                            {% if puppy.activity_level == "bajo" or not puppy.activity_level %}
                            <img src="{% static 'images/sedentario.svg' %}" id="activity_image_container">
                            {% elif puppy.activity_level == "medio" %}
                            <img src="{% static 'images/activo.svg' %}" id="activity_image_container">
                            {% else %}
                            <img src="{% static 'images/muy_activo.svg' %}" id="activity_image_container">
                            {% endif %}
                        </div>

                        <div class="field button">
                            <button type="button" id="nextBtn" onclick="nextPrev(1)">Continuar</button>
                        </div>

                        <div class="link"><a href="{% url 'login' %}">Cancelar</a></div>
                    </div>

                    <div class="multistep_form_tab">
                        <div class="form_back_section">
                            <span class="step-indicator">4 de 5</span>
                            <div class="back_icon_container">
                                <i class="fa fa-angle-left"></i>
                                <button type="button" onclick="nextPrev(-1)" class="multistep_form_back_button"><p>Volver</p></button>
                            </div>
                        </div> 

                        <div class="form_header">
                            <h3>Peso</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                        </div>

                        <div class="carousel_container">

                            <div class="arrow_container left_arrow_container">
                                <i class="fa fa-angle-left" id="left" onClick="changeImgCarousel(this.id);"></i>
                            </div>

                            <div class="carousel">
                                <div class="carousel-item {% if puppy.body_image == 'muy_delgado' %}active{% endif %}">
                                    <img id='muy_delgado' src="{% static 'images/muy_delgado.svg' %}" class="body_image">
                                </div>

                                <div class="carousel-item {% if puppy.body_image == 'delgado' %}active{% endif %}">
                                    <img id='delgado' src="{% static 'images/delgado.svg' %}" class="body_image">
                                </div>

                                <div class="carousel-item {% if puppy.body_image == 'peso_ideal' or not puppy.body_image %}active{% endif %}">
                                    <img id='peso_ideal' src="{% static 'images/ideal.svg' %}" class="body_image">
                                </div>

                                <div class="carousel-item {% if puppy.body_image == 'sobrepeso' %}active{% endif %}">
                                    <img id='sobrepeso' src="{% static 'images/sobrepeso.svg' %}" class="body_image">
                                </div>
                            </div>

                            <div class="arrow_container right_arrow_container">
                                <i class="fa fa-angle-right"  id="next" onClick="changeImgCarousel(this.id);"></i>
                            </div>
                        </div>

                        <input id="input_weight_image" name='body_image' type="hidden" value="{{ puppy.body_image|default:'peso_ideal' }}">

                        <div class="field input">
                            <input type="text" id="id_weight" name="weight" value="{{ form.weight.value|floatformat:0 }}" placeholder="Peso (kg)" required>
                        </div>

                        <div class="field button">
                            <button type="button" id="nextBtn" onclick="nextPrev(1)">Continuar</button>
                        </div>

                        <div class="link"><a href="{% url 'login' %}">Cancelar</a></div>
                    </div>

                    <div class="multistep_form_tab">
                        <div class="form_back_section">
                            <span class="step-indicator">5 de 5</span>
                            <div class="back_icon_container">
                                <i class="fa fa-angle-left"></i>
                                <button type="button" onclick="nextPrev(-1)" class="multistep_form_back_button"><p>Volver</p></button>
                            </div>
                        </div> 

                        <div class="form_header">
                            <h3>Alergias y necesidades</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                        </div>



                        <div class="form_breed_input">
                          <div class="field input">
                            <select id="id_allergies" name="allergies">
                              {% for allergy in form.allergies.field.choices %}
                              <option value="{{allergy.0}}" {% if allergy.0 == form.allergies.value %}selected{% endif %}>{{allergy.1}}</option>
                              {% endfor %}
                            </select>
                          </div>
                        </div>

                        <div class="form_breed_input">
                            <div class="field input">
                                <select name="{{form.special_needs.name}}" id="{{form.special_needs.id_for_label}}">
                                    {% for option in form.special_needs.field.choices %}
                                        <option value="{{ option.0 }}" {% if form.special_needs.value == option.0 %}selected{% endif %}>{{ option.1 }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        {% if request.user.is_authenticated %}
                        <div class="field button">
                            <input type="submit" value="Completar" class="btn" />
                        </div>
                        {% else %}
                        <div class="field button">
                            <button type="button" id="nextBtn" onclick="nextPrev(1)">Continuar</button>
                        </div>
                        {% endif %}

                        <div class="link"><a href="{% url 'login' %}">Cancelar</a></div>
                    </div>

                    {% if not request.user.is_authenticated %}
                    <div class="multistep_form_tab contact_detail_tab">
                        <div class="form_back_section">
                        <div class="back_icon_container">
                            <i class="fa fa-angle-left"></i>
                            <button type="button" onclick="nextPrev(-1)" class="multistep_form_back_button"><p>Volver</p></button>
                        </div>
                        </div> 

                        <div class="form_header_image">
                        <img src="{% static 'images/contact_detail_image2.svg' %}">
                        </div>

                        <div class="form_header">
                            <h3>¡Ya tenemos la dieta perfecta para <span id="name_container"></span>!</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                        </div>

                        <div class="form_name_input">
                            <div class="field input">
                                <input type="text" name="name_contact" placeholder="Nombre dueño" value="">
                            </div>
                        </div>

                        <div class="form_name_input">
                            <div class="field input">
                                <input type="text" name="email_contact" placeholder="Correo electrónico" value="">
                            </div>
                        </div>

                        <div class="field button">
                            <input type="submit" value="Conocer dieta" class="btn" />
                        </div>

                        <div class="link"><a href="{% url 'login' %}">Cancelar</a></div>
                    </div>
                    {% endif %}
                </form>
            </section>
        </div>
    </div>  
</main>

<!-- Trigger showTab for the first time in the wizard html only -->
<script>
    window.addEventListener('load', () => {
        showTab(currentTab || 0);
    }, { once: true });
</script>

{% endblock %}